<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ˆæ¡ˆè¡ŒéŠ·è«‹å‡ç³»çµ±</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ['Inter', 'sans-serif'] },
            animation: { 'fade-in-down': 'fadeInDown 0.3s ease-out' },
            keyframes: {
              fadeInDown: {
                '0%': { opacity: '0', transform: 'translateY(-20px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              }
            }
          }
        }
      }
    </script>

    <!-- Babel for in-browser JSX compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Import Map: ä¿®æ­£ React ç‰ˆæœ¬è¡çªï¼Œçµ±ä¸€ä½¿ç”¨ 18.2.0 -->
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0?dev",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client?dev",
    "@google/genai": "https://esm.sh/@google/genai",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>

    <style>
      ::-webkit-scrollbar { width: 8px; height: 8px; }
      ::-webkit-scrollbar-track { background: #f1f1f1; }
      ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
      ::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
    </style>
  </head>
  <body class="bg-slate-50 text-slate-900 font-sans">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
      import React, { useState, useEffect, useContext, createContext, useCallback, useRef } from 'react';
      import ReactDOM from 'react-dom/client';
      import { GoogleGenAI } from "@google/genai";

      // --- Error Boundary ---
      class ErrorBoundary extends React.Component {
        constructor(props) {
          super(props);
          this.state = { hasError: false, error: null };
        }
        static getDerivedStateFromError(error) { return { hasError: true, error }; }
        render() {
          if (this.state.hasError) {
            return (
              <div className="min-h-screen flex items-center justify-center bg-slate-50 p-4">
                <div className="bg-white p-8 rounded-lg shadow-xl max-w-lg w-full text-center">
                  <h1 className="text-2xl font-bold text-red-600 mb-4">ç³»çµ±å•Ÿå‹•å¤±æ•—</h1>
                  <button onClick={() => { localStorage.clear(); window.location.reload(); }} className="bg-red-600 text-white px-6 py-2 rounded">é‡ç½®ä¸¦é‡æ•´</button>
                </div>
              </div>
            );
          }
          return this.props.children;
        }
      }

      // --- 1. CONSTANTS ---
      const UserRole = { ADMIN: 'ADMIN', USER: 'USER' };
      const RequestType = { OVERTIME: 'OVERTIME', LEAVE: 'LEAVE' };
      const RequestStatus = { PENDING: 'PENDING', APPROVED: 'APPROVED', REJECTED: 'REJECTED' };
      const SEED_ADMIN = { id: 'admin-1', username: 'admin', password: 'admin123', role: UserRole.ADMIN, compTimeBalance: 0 };

      const safeJsonParse = (key, fallback) => {
        try {
          const item = localStorage.getItem(key);
          if (!item) return fallback;
          const parsed = JSON.parse(item);
          return parsed || fallback;
        } catch (e) {
          console.error(`Error parsing ${key}`, e);
          return fallback;
        }
      };

      // --- 2. GEMINI SERVICE ---
      const getAiClient = () => {
        const apiKey = process.env.API_KEY || window.API_KEY;
        return apiKey ? new GoogleGenAI({ apiKey }) : null;
      };

      const polishReason = async (input, type) => {
        const ai = getAiClient();
        if (!ai) return input;
        const typeText = type === RequestType.OVERTIME ? 'åŠ ç­' : 'è£œä¼‘';
        const prompt = `ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„äººè³‡åŠ©ç†ã€‚è«‹å¹«æˆ‘æ½¤é£¾ä»¥ä¸‹ã€Œ${typeText}ç”³è«‹ã€çš„åŸå› ï¼Œä½¿å…¶æ›´å°ˆæ¥­ã€ç°¡æ½”ä¸”æ¸…æ™°ã€‚åªéœ€è¼¸å‡ºæ½¤é£¾å¾Œçš„ç¹é«”ä¸­æ–‡æ–‡å­—ã€‚è¼¸å…¥: "${input}"`;
        try {
          const response = await ai.models.generateContent({ model: 'gemini-3-flash-preview', contents: prompt });
          return response.text.trim();
        } catch (error) { return input; }
      };

      // --- 3. CONTEXT (Persistence Logic) ---
      const DataContext = createContext();

      const DataProvider = ({ children }) => {
        // æ ¸å¿ƒä¿®æ­£ï¼šä½¿ç”¨ useRef è¿½è¹¤æ˜¯å¦ç‚ºåˆæ¬¡æ¸²æŸ“ï¼Œé˜²æ­¢ç©ºç‹€æ…‹è¦†è“‹ LocalStorage
        const isInitialMount = useRef(true);

        const [users, setUsers] = useState(() => {
            const loaded = safeJsonParse('app_users', []);
            let list = Array.isArray(loaded) && loaded.length > 0 ? loaded : [SEED_ADMIN];
            if (!list.some(u => u.username === 'admin')) list = [SEED_ADMIN, ...list];
            return list;
        });
        
        const [requests, setRequests] = useState(() => safeJsonParse('app_requests', []));
        const [currentUser, setCurrentUser] = useState(() => safeJsonParse('app_session', null));
        const [notification, setNotification] = useState(null);

        // è³‡æ–™æŒä¹…åŒ–ï¼šç¢ºä¿åªæœ‰åœ¨éåˆæ¬¡æ¸²æŸ“ä¸”è³‡æ–™å­˜åœ¨æ™‚æ‰å¯«å…¥
        useEffect(() => {
          if (isInitialMount.current) {
            isInitialMount.current = false;
            return;
          }
          localStorage.setItem('app_users', JSON.stringify(users));
        }, [users]);

        useEffect(() => {
          localStorage.setItem('app_requests', JSON.stringify(requests));
        }, [requests]);

        useEffect(() => {
          if (currentUser) {
            localStorage.setItem('app_session', JSON.stringify(currentUser));
            const freshUser = users.find(u => u.id === currentUser.id);
            if (freshUser && (freshUser.compTimeBalance !== currentUser.compTimeBalance || freshUser.password !== currentUser.password)) {
              setCurrentUser(freshUser);
            }
          } else {
            localStorage.removeItem('app_session');
          }
        }, [currentUser, users]);

        const showNotification = (message, type) => {
          setNotification({ message, type });
          setTimeout(() => setNotification(null), 3000);
        };

        const login = useCallback((username, pass) => {
          const user = users.find(u => u.username.trim() === username.trim() && u.password.trim() === pass.trim());
          if (user) { setCurrentUser(user); return true; }
          return false;
        }, [users]);

        const logout = () => { setCurrentUser(null); localStorage.removeItem('app_session'); };

        const addUser = (userData) => {
          if (users.some(u => u.username === userData.username)) {
            showNotification('å¸³è™Ÿå·²å­˜åœ¨', 'error');
            return;
          }
          const newUser = { ...userData, id: Date.now().toString(), compTimeBalance: 0 };
          setUsers(prev => [...prev, newUser]);
          showNotification('å¸³è™Ÿå»ºç«‹æˆåŠŸä¸¦å·²å„²å­˜', 'success');
        };

        const deleteUser = (id) => {
          setUsers(prev => prev.filter(u => u.id !== id));
          showNotification('ä½¿ç”¨è€…å·²åˆªé™¤', 'success');
        };

        const updatePassword = (id, newPass) => {
          setUsers(prev => prev.map(u => u.id === id ? { ...u, password: newPass.trim() } : u));
          showNotification('å¯†ç¢¼ä¿®æ”¹æˆåŠŸä¸¦å·²å„²å­˜', 'success');
        };

        const submitRequest = (reqData) => {
          if (!currentUser) return;
          let calculated = parseFloat(reqData.hours);
          if (reqData.type === RequestType.OVERTIME) {
            const day = new Date(reqData.date).getDay();
            if (day === 0 || day === 6) calculated = 8;
          }
          if (reqData.type === RequestType.LEAVE && currentUser.compTimeBalance < reqData.hours) {
            showNotification('è£œä¼‘é¤˜é¡ä¸è¶³', 'error'); return;
          }
          const newReq = { ...reqData, id: Date.now().toString(), userId: currentUser.id, username: currentUser.username, status: RequestStatus.PENDING, calculatedHours: calculated, createdAt: new Date().toISOString() };
          setRequests(prev => [newReq, ...prev]);
          showNotification('ç”³è«‹å–®å·²é€å‡º', 'success');
        };

        const processRequest = (requestId, status) => {
          const req = requests.find(r => r.id === requestId);
          if (!req) return;
          if (status === RequestStatus.APPROVED) {
            const targetUser = users.find(u => u.id === req.userId);
            if (targetUser) {
              let newBalance = targetUser.compTimeBalance;
              if (req.type === RequestType.OVERTIME) newBalance += req.calculatedHours;
              else newBalance -= req.hours;
              setUsers(prev => prev.map(u => u.id === targetUser.id ? { ...u, compTimeBalance: newBalance } : u));
            }
          }
          setRequests(prev => prev.map(r => r.id === requestId ? { ...r, status } : r));
          showNotification('å¯©æ ¸å®Œæˆ', 'success');
        };

        return (
          <DataContext.Provider value={{ users, currentUser, requests, notification, login, logout, addUser, deleteUser, updatePassword, submitRequest, processRequest, showNotification }}>
            {children}
          </DataContext.Provider>
        );
      };

      const useData = () => useContext(DataContext);

      // --- 4. COMPONENTS ---
      const Login = () => {
        const { login } = useData();
        const [username, setUsername] = useState('');
        const [password, setPassword] = useState('');
        const [error, setError] = useState('');
        const handleSubmit = (e) => {
          e.preventDefault();
          setError('');
          if (!login(username, password)) setError('å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥ã€‚');
        };
        return (
          <div className="min-h-screen bg-slate-100 flex items-center justify-center p-4">
            <div className="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border border-slate-200">
              <div className="text-center mb-8">
                <h1 className="text-3xl font-extrabold text-slate-800">å°ˆæ¡ˆè¡ŒéŠ·è«‹å‡ç³»çµ±</h1>
                <p className="text-slate-500 mt-2 text-sm">è«‹è¼¸å…¥æ‚¨çš„å¸³è™Ÿå¯†ç¢¼</p>
              </div>
              <form onSubmit={handleSubmit} className="space-y-6">
                <div><label className="block text-sm font-bold text-slate-700 mb-1">å¸³è™Ÿ</label><input type="text" required className="w-full px-4 py-3 rounded-lg border border-slate-300 outline-none focus:ring-2 focus:ring-blue-500 bg-slate-50 transition" value={username} onChange={e => setUsername(e.target.value)} /></div>
                <div><label className="block text-sm font-bold text-slate-700 mb-1">å¯†ç¢¼</label><input type="password" required className="w-full px-4 py-3 rounded-lg border border-slate-300 outline-none focus:ring-2 focus:ring-blue-500 bg-slate-50 transition" value={password} onChange={e => setPassword(e.target.value)} /></div>
                {error && <div className="bg-red-50 text-red-600 p-3 rounded-lg text-sm border border-red-100 animate-fade-in-down">{error}</div>}
                <button type="submit" className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-lg transition">ç™»å…¥ç³»çµ±</button>
              </form>
            </div>
          </div>
        );
      };

      const Layout = ({ children, activeTab, setActiveTab }) => {
        const { currentUser, logout, notification } = useData();
        const [isOpen, setIsOpen] = useState(false);
        if (!currentUser) return children;
        const isAdmin = currentUser.role === UserRole.ADMIN;
        const NavItem = ({ id, label, icon }) => (
          <button onClick={() => { setActiveTab(id); setIsOpen(false); }} className={`flex items-center space-x-3 px-6 py-3 w-full text-left transition ${activeTab === id ? 'bg-blue-50 text-blue-700 border-r-4 border-blue-600' : 'text-slate-600 hover:bg-slate-50'}`}>
            <span className="text-xl">{icon}</span><span className="font-medium">{label}</span>
          </button>
        );
        return (
          <div className="min-h-screen bg-slate-100 flex flex-col md:flex-row">
            {notification && <div className={`fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg text-white animate-fade-in-down ${notification.type === 'error' ? 'bg-red-500' : 'bg-green-600'}`}>{notification.message}</div>}
            <aside className="hidden md:flex flex-col w-72 bg-white shadow-xl h-screen sticky top-0">
              <div className="p-8 border-b"><h1 className="text-2xl font-bold">å°ˆæ¡ˆè¡ŒéŠ·</h1><p className="text-sm mt-4 font-bold text-slate-700">ç”¨æˆ¶ï¼š{currentUser.username}</p><p className="text-xs text-slate-500">æ¬Šé™ï¼š{isAdmin ? 'ç®¡ç†å“¡' : 'ä¸€èˆ¬ç”¨æˆ¶'}</p></div>
              <nav className="flex-1 py-6"><NavItem id="dashboard" label="å„€è¡¨æ¿" icon="ğŸ“Š" /><NavItem id="apply" label="ç”³è«‹åŠ ç­/è£œä¼‘" icon="ğŸ“" />{isAdmin && <NavItem id="admin" label="ç®¡ç†å¾Œå°" icon="âš™ï¸" />}<NavItem id="settings" label="å€‹äººè¨­å®š" icon="ğŸ‘¤" /></nav>
              <div className="p-6 border-t text-center"><button onClick={logout} className="text-red-600 font-bold hover:underline">ğŸšª ç™»å‡ºç³»çµ±</button></div>
            </aside>
            <div className="md:hidden bg-white p-4 shadow flex justify-between items-center sticky top-0 z-20"><h1 className="font-bold">å°ˆæ¡ˆè¡ŒéŠ·</h1><button onClick={() => setIsOpen(!isOpen)} className="text-2xl">â˜°</button></div>
            {isOpen && <div className="md:hidden bg-white border-b absolute top-14 left-0 w-full z-10 shadow-lg"><NavItem id="dashboard" label="å„€è¡¨æ¿" icon="ğŸ“Š" /><NavItem id="apply" label="ç”³è«‹åŠ ç­/è£œä¼‘" icon="ğŸ“" />{isAdmin && <NavItem id="admin" label="ç®¡ç†å¾Œå°" icon="âš™ï¸" />}<NavItem id="settings" label="å€‹äººè¨­å®š" icon="ğŸ‘¤" /><button onClick={logout} className="p-4 text-red-600 w-full text-left font-bold border-t">ç™»å‡º</button></div>}
            <main className="flex-1 p-4 md:p-8 overflow-y-auto"><div className="max-w-6xl mx-auto">{children}</div></main>
          </div>
        );
      };

      const Dashboard = () => {
        const { currentUser, requests } = useData();
        const myRequests = requests.filter(r => r.userId === currentUser.id);
        return (
          <div className="space-y-6 animate-fade-in-down">
            <h2 className="text-2xl font-bold">æˆ‘çš„å„€è¡¨æ¿</h2>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              <div className="bg-white p-6 rounded-xl shadow border">ç›®å‰è£œä¼‘é¤˜é¡<p className="text-4xl font-bold text-blue-600 mt-2">{currentUser.compTimeBalance} hr</p></div>
              <div className="bg-white p-6 rounded-xl shadow border">å¾…å¯©æ ¸ç”³è«‹<p className="text-4xl font-bold text-yellow-500 mt-2">{myRequests.filter(r=>r.status==='PENDING').length}</p></div>
              <div className="bg-white p-6 rounded-xl shadow border">ç¸½ç”³è«‹ç´€éŒ„<p className="text-4xl font-bold text-slate-600 mt-2">{myRequests.length}</p></div>
            </div>
            <div className="bg-white rounded-xl shadow border overflow-hidden">
               <div className="p-4 bg-slate-50 font-bold">æ­·å²ç´€éŒ„</div>
               <div className="overflow-x-auto"><table className="w-full text-left text-sm"><thead className="bg-slate-100"><tr><th className="p-4">æ—¥æœŸ</th><th className="p-4">é¡å‹</th><th className="p-4">æ™‚æ•¸</th><th className="p-4">ç‹€æ…‹</th><th className="p-4">åŸå› </th></tr></thead><tbody className="divide-y">{myRequests.map(r=>(<tr key={r.id} className="hover:bg-slate-50"><td className="p-4">{r.date}</td><td className="p-4 font-bold">{r.type==='OVERTIME'?'åŠ ç­':'è£œä¼‘'}</td><td className="p-4">{r.type==='OVERTIME'?`+${r.calculatedHours}`:`-${r.hours}`}</td><td className="p-4">{r.status==='APPROVED'?'âœ…':r.status==='REJECTED'?'âŒ':'â³'}</td><td className="p-4 text-slate-500">{r.reason}</td></tr>))}</tbody></table></div>
            </div>
          </div>
        );
      };

      const RequestForm = () => {
        const { submitRequest, showNotification } = useData();
        const [type, setType] = useState(RequestType.OVERTIME);
        const [date, setDate] = useState('');
        const [startTime, setStartTime] = useState('09:00');
        const [hours, setHours] = useState(0);
        const [reason, setReason] = useState('');
        const [polishing, setPolishing] = useState(false);
        const handleDateChange = (e) => {
          const val = e.target.value;
          if (val && type === RequestType.LEAVE) {
            const day = new Date(val).getDay();
            if (day === 0 || day === 6) { showNotification('è£œä¼‘åƒ…é™å¹³æ—¥ç”³è«‹', 'error'); setDate(''); return; }
          }
          setDate(val);
        };
        const handleAi = async () => {
          if (!reason) return; setPolishing(true);
          const res = await polishReason(reason, type); setReason(res); setPolishing(false);
        };
        return (
          <div className="bg-white p-8 rounded-xl shadow border max-w-2xl mx-auto animate-fade-in-down">
            <h2 className="text-xl font-bold mb-6">æ–°å¢ç”³è«‹å–®</h2>
            <div className="flex space-x-4 mb-6"><button onClick={()=>setType(RequestType.OVERTIME)} className={`flex-1 py-3 rounded-lg font-bold ${type==='OVERTIME'?'bg-blue-600 text-white':'bg-slate-100 text-slate-500'}`}>ç”³è«‹åŠ ç­</button><button onClick={()=>{setType(RequestType.LEAVE); setDate('');}} className={`flex-1 py-3 rounded-lg font-bold ${type==='LEAVE'?'bg-orange-500 text-white':'bg-slate-100 text-slate-500'}`}>ç”³è«‹è£œä¼‘</button></div>
            <form onSubmit={e=>{e.preventDefault(); submitRequest({type, date, startTime, hours: parseFloat(hours), reason}); setDate(''); setReason('');}} className="space-y-4">
              <div className="grid grid-cols-2 gap-4"><div>æ—¥æœŸ<input type="date" required value={date} onChange={handleDateChange} className="w-full border p-2 rounded" /></div><div>æ™‚é–“<input type="time" required value={startTime} onChange={e=>setStartTime(e.target.value)} className="w-full border p-2 rounded" /></div></div>
              <div>æ™‚æ•¸<input type="number" step="0.5" required value={hours||''} onChange={e=>setHours(e.target.value)} className="w-full border p-2 rounded" /></div>
              <div className="relative">åŸå› <textarea required value={reason} onChange={e=>setReason(e.target.value)} className="w-full border p-2 rounded h-32" /><button type="button" onClick={handleAi} className="absolute bottom-2 right-2 p-2 bg-indigo-500 text-white rounded-full">{polishing?'...':'âœ¨'}</button></div>
              <button className="w-full bg-slate-900 text-white py-3 rounded-lg font-bold shadow-lg">é€å‡ºç”³è«‹</button>
            </form>
          </div>
        );
      };

      const AdminPanel = () => {
        const { users, requests, addUser, deleteUser, updatePassword, processRequest, currentUser } = useData();
        const [view, setView] = useState('requests');
        const [u, setU] = useState(''); const [p, setP] = useState(''); const [r, setR] = useState(UserRole.USER);
        if (currentUser.role !== UserRole.ADMIN) return <div>ç„¡æ¬Šé™</div>;
        return (
          <div className="space-y-6 animate-fade-in-down">
            <div className="flex space-x-2"><button onClick={()=>setView('requests')} className={`px-4 py-2 rounded ${view==='requests'?'bg-slate-800 text-white':'bg-white'}`}>å¾…æ ¸å‡†</button><button onClick={()=>setView('users')} className={`px-4 py-2 rounded ${view==='users'?'bg-slate-800 text-white':'bg-white'}`}>å¸³è™Ÿç®¡ç†</button></div>
            {view === 'requests' ? (
              <div className="bg-white rounded-xl shadow border divide-y">{requests.filter(x=>x.status==='PENDING').map(req=>(<div key={req.id} className="p-4 flex justify-between items-center"><div><span className="font-bold">{req.username}</span> - {req.type==='OVERTIME'?'åŠ ç­':'è£œä¼‘'} {req.hours}hr<p className="text-xs text-slate-500">{req.date} {req.startTime}</p><p className="mt-1">"{req.reason}"</p></div><div className="flex space-x-2"><button onClick={()=>processRequest(req.id,'APPROVED')} className="bg-green-500 text-white px-4 py-1 rounded">å‡†</button><button onClick={()=>processRequest(req.id,'REJECTED')} className="bg-red-500 text-white px-4 py-1 rounded">å¦</button></div></div>))}</div>
            ) : (
              <div className="space-y-6">
                <form className="bg-white p-6 rounded shadow border grid grid-cols-4 gap-4 items-end" onSubmit={e=>{e.preventDefault(); addUser({username:u, password:p, role:r}); setU(''); setP('');}}>
                  <input placeholder="å¸³è™Ÿ" value={u} onChange={e=>setU(e.target.value)} required className="border p-2 rounded" /><input placeholder="å¯†ç¢¼" type="password" value={p} onChange={e=>setP(e.target.value)} required className="border p-2 rounded" /><select value={r} onChange={e=>setR(e.target.value)} className="border p-2 rounded"><option value={UserRole.USER}>ç”¨æˆ¶</option><option value={UserRole.ADMIN}>ç®¡ç†å“¡</option></select><button className="bg-blue-600 text-white p-2 rounded font-bold">æ–°å¢ç”¨æˆ¶</button>
                </form>
                <div className="bg-white rounded shadow border overflow-hidden"><table className="w-full text-left text-sm"><thead className="bg-slate-50"><tr><th className="p-4">å¸³è™Ÿ</th><th className="p-4">è§’è‰²</th><th className="p-4">é¤˜é¡</th><th className="p-4 text-right">æ“ä½œ</th></tr></thead><tbody className="divide-y">{users.map(user=>(<tr key={user.id}><td className="p-4 font-bold">{user.username}</td><td className="p-4">{user.role}</td><td className="p-4">{user.compTimeBalance}hr</td><td className="p-4 text-right"><button onClick={()=>{const n=prompt('æ–°å¯†ç¢¼'); if(n) updatePassword(user.id,n);}} className="text-blue-600 mr-4">æ›´æ›å¯†ç¢¼</button>{user.id!==currentUser.id && <button onClick={()=>deleteUser(user.id)} className="text-red-500">åˆªé™¤</button>}</td></tr>))}</tbody></table></div>
              </div>
            )}
          </div>
        );
      };

      const Settings = () => {
        const { currentUser, updatePassword } = useData();
        const [p, setP] = useState(''); const [c, setC] = useState('');
        return (
          <div className="bg-white p-8 rounded-xl shadow border max-w-md mx-auto animate-fade-in-down">
            <h2 className="text-xl font-bold mb-6">ä¿®æ”¹å¯†ç¢¼</h2>
            <form onSubmit={e=>{e.preventDefault(); if(p===c) updatePassword(currentUser.id,p); setP(''); setC('');}} className="space-y-4">
              <input type="password" placeholder="æ–°å¯†ç¢¼" value={p} onChange={e=>setP(e.target.value)} required className="w-full border p-2 rounded" /><input type="password" placeholder="ç¢ºèªæ–°å¯†ç¢¼" value={c} onChange={e=>setC(e.target.value)} required className="w-full border p-2 rounded" /><button className="w-full bg-slate-900 text-white py-3 rounded-lg font-bold">é€å‡ºä¿®æ”¹</button>
            </form>
          </div>
        );
      };

      const AppContent = () => {
        const { currentUser } = useData();
        const [tab, setTab] = useState('dashboard');
        if (!currentUser) return <Login />;
        return <Layout activeTab={tab} setActiveTab={setTab}>{tab === 'dashboard' ? <Dashboard /> : tab === 'apply' ? <RequestForm /> : tab === 'admin' ? <AdminPanel /> : <Settings />}</Layout>;
      };

      ReactDOM.createRoot(document.getElementById('root')).render(<DataProvider><ErrorBoundary><AppContent /></ErrorBoundary></DataProvider>);
    </script>
  </body>
</html>